!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){var e="[data-sparta-event-dispatcher]",t=document.querySelector(e);if(!t){var n=document.createElement("div");n.setAttribute("data-sparta-event-dispatcher",!0);var a=document.getElementsByTagName("script"),r=a[a.length-1].src.split("/");return r[r.length-1]="loading.gif",d=r.join("/"),n}return t}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1);var d=void 0,s={ERROR_LOADING_WIDGET:"errorLoadingWidget",REFRESH_WIDGET:"refreshWidget"},c=function(){function e(){r(this,e),this.dispatcherElement=i()}return o(e,[{key:"pub",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new CustomEvent(e,{detail:t});this.dispatcherElement.dispatchEvent(n)}},{key:"sub",value:function(e,t){this.dispatcherElement.addEventListener(e,t)}},{key:"unsub",value:function(e,t){this.dispatcherElement.removeEventListener(e,t)}},{key:"once",value:function(e,t){var n=this,a=function a(r){n.dispatcherElement.removeEventListener(e,a),t(r)};this.dispatcherElement.addEventListener(e,a)}},{key:"load",value:function(e){var t=e.name,n=e.version,r=e.container,i=e.path,o=e.spinner,d=e.options,c=void 0===d?{}:d,u=e.language,l=void 0===u?"en":u;if(!t||!n||!r)return console.error("invalid config object passed to widget loader"),!1;var p=[],v=[];"[object Array]"===Object.prototype.toString.call(r)?(window.sparta.widgetLoader[t]=a({},n,{}),p=r):p.push(r),p.forEach(function(e){var t=document.getElementById(e);return t?void v.push(t):(console.error("widget container destination does not exist"),!1)}),document.querySelectorAll('[data-sparta-container="'+t+'"][data-version="'+n+'"]').length>0?this.pub(s.REFRESH_WIDGET,{name:t,version:n,container:v}):(this.generateStyleSheet(v,o),this.widgetXHR(v,i,t,n,c,l))}},{key:"generateStyleSheet",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.forEach(function(e){var n=document.createElement("style"),a="\n        #"+e.id+" > [data-sparta-container].sparta-widget-loading,\n        #"+e.id+" > [data-sparta-container].sparta-widget-loading > .sparta-widget {\n          visibility: hidden;\n          height: 100%;\n          widht: 100%;\n        }\n      ";t&&(a+="\n          #"+e.id+".sparta-widget-loading {\n            height: 100%;\n            background-image: url('"+d+"');\n            background-repeat: no-repeat;\n            background-position: center center;\n          }\n        "),n.type="text/css",n.id=e.id+"-sparta-widget-style-sheet",n.stylesSheet?n.styleSheet.cssText=a:n.appendChild(document.createTextNode(a)),document.head.appendChild(n),e.classList.add("sparta-widget-loading")})}},{key:"widgetXHR",value:function(e,t,n,a,r,i){var o=new XMLHttpRequest,d=i&&"en"!==i.toLowerCase()?i.toLowerCase()+"/":"",c=t+"/spa/widgets/"+n+"/"+a+"/"+d+"index.html",u=this;o.onreadystatechange=function(){var i=this;4===this.readyState&&(200!==this.status?(console.error("unable to load widget:",c,this.status),e.forEach(function(e){e.innerHTML="unable to load widget",u.pub(s.ERROR_LOADING_WIDGET,{widget:{name:n,version:a,path:t,container:e},xhrReq:i})})):!function(){e.forEach(function(e){e.innerHTML=i.responseText});var t=e[e.length-1];t.querySelector("[data-sparta-widget]").setAttribute("data-sparta-options",JSON.stringify(r)),t.style.height="auto",t.style.backgroundImage="";var n=[].slice.call(t.querySelectorAll("script"));n.forEach(function(e){var n=document.createElement("script");e.src?n.src=e.src:n.innerHTML=e.innerHTML,t.appendChild(n),e.parentNode.removeChild(e)})}())},o.open("GET",c),o.send()}}]),e}();if(!window.sparta||!window.sparta.widgetLoader){var u=new c;window.sparta=window.sparta||{},window.sparta.widgetLoader=u,document.dispatchEvent(new CustomEvent("spartaLoaderLoaded"))}},function(e,t){try{var n=new window.CustomEvent("test");if(n.preventDefault(),n.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch(e){var a=function(e,t){var n,a;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a=n.preventDefault,n.preventDefault=function(){a.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n};a.prototype=window.Event.prototype,window.CustomEvent=a}}]);
//# sourceMappingURL=index.js.map